<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Configuration - Terraform & Ansible Intro</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Configuration";
    var mkdocs_page_input_path = "configuration.md";
    var mkdocs_page_url = "/configuration/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Terraform & Ansible Intro</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../getting-started/">Getting Started</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Configuration</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#configuration">Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#install-terraform-and-ansible">Install Terraform and Ansible</a></li>
        
            <li><a class="toctree-l4" href="#configure-the-google-cloud-sdk">Configure the Google Cloud SDK</a></li>
        
            <li><a class="toctree-l4" href="#enable-the-compute-engine-api">Enable the Compute Engine API</a></li>
        
            <li><a class="toctree-l4" href="#configure-api-credentials">Configure API credentials</a></li>
        
            <li><a class="toctree-l4" href="#configure-ssh-credentials">Configure SSH credentials</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../deployment/">Deployment</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Terraform Lab</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../terraform-background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../terraform-lab/">Lab Activities</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Ansible Lab</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ansible-background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../ansible-lab/">Lab Activities</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../comparison/">Comparison</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Terraform & Ansible Intro</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Setup &raquo;</li>
        
      
    
    <li>Configuration</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="configuration">Configuration</h1>
<p>In this activity you will:</p>
<ul>
<li>Install Terraform and Ansible</li>
<li>Configure the Google Cloud SDK</li>
<li>Enable the Compute Engine API</li>
<li>Configure API credentials</li>
<li>Configure SSH credentials</li>
</ul>
<hr />
<p><strong>NOTE:</strong>  All of the commands listed within this activity should be executed within the Google Cloud Shell - <strong>not on your laptop</strong>.</p>
<hr />
<h2 id="install-terraform-and-ansible">Install Terraform and Ansible</h2>
<ol>
<li>
<p>Download the lab repository to your home directory.</p>
<pre><code>$ git clone https://github.com/PaloAltoNetworks/terraform-ansible-intro
</code></pre>
</li>
<li>
<p>Change into the lab directoryu and run the lab configuration script.  This will install the Terraform binary and the Ansible package.</p>
<pre><code>$ cd terraform-ansible-intro
$ ./labconfig.sh
</code></pre>
</li>
<li>
<p>Test to ensure the Terraform and Ansible binaries are properly installed.  Both executables should be located in the <code>/usr/local/bin</code> directory.</p>
<pre><code>$ terraform --version
$ ansible --version
</code></pre>
</li>
</ol>
<h2 id="configure-the-google-cloud-sdk">Configure the Google Cloud SDK</h2>
<ol>
<li>
<p>Use the following <code>gcloud config</code> command to select the Qwiklabs project identifier.  If you had multiple projects this would ensure subsequent <code>gcloud</code> commands are scoped to this specific project.</p>
<pre><code>$ gcloud config set project &lt;PROJECT&gt;
</code></pre>
</li>
<li>
<p>Confirm the project selection was successful.</p>
<pre><code>$ gcloud config get-value project
</code></pre>
</li>
</ol>
<h2 id="enable-the-compute-engine-api">Enable the Compute Engine API</h2>
<ol>
<li>Use the following <code>gcloud services</code> command to enable the Compute Engine API.  This API will be used by Terraform to deploy the VM-Series instance.<pre><code>$ gcloud services enable compute.googleapis.com
</code></pre>
</li>
</ol>
<h2 id="configure-api-credentials">Configure API credentials</h2>
<ol>
<li>
<p>Use the following <code>gcloud iam</code> command to list the default service accounts.</p>
<pre><code>$ gcloud iam service-accounts list
</code></pre>
</li>
<li>
<p>Locate the Compute Engine default service account and its email address.</p>
</li>
<li>Use the following <code>gcloud iam</code> command to download the credentials for the Compute Engine default service account.<pre><code>$ gcloud iam service-accounts keys create gcp_compute_key.json --iam-account &lt;EMAIL_ADDRESS&gt;
</code></pre>
</li>
</ol>
<h2 id="configure-ssh-credentials">Configure SSH credentials</h2>
<ol>
<li>
<p>Create an SSH key with an empty passphrase and save it in the <code>~/.ssh</code> directory.</p>
<pre><code>$ ssh-keygen -t rsa -b 1024 -N '' -f ~/.ssh/sko19_ssh_key
</code></pre>
</li>
<li>
<p>Ensure the file permissions for the SSH key are secure.</p>
<pre><code>$ chmod 400 ~/.ssh/sko19_ssh_key
</code></pre>
</li>
<li>
<p>Use the following <code>gcloud compute</code> command to override the default GCP key management process and utilize our SSH key.</p>
<pre><code>$ gcloud compute config-ssh --ssh-key-file=~/.ssh/sko19_ssh_key
</code></pre>
</li>
</ol>
<hr />
<p><strong>NOTE:</strong> GCP has the ability to manage all of its own SSH keys and propagate them automatically to projects and instances.  However, the VM-Series is only able to make use of a single SSH key.  Rather than leverage GCP's SSH key management process, we've created our own SSH key and configured the Compute Engine to use our key exclusively.  When we deploy the VM-Series in the next activity we'll instruct the instance to also use the SSH key we've created.</p>
<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../deployment/" class="btn btn-neutral float-right" title="Deployment">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting-started/" class="btn btn-neutral" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../getting-started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../deployment/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../search/require.js"></script>
      <script src="../search/search.js"></script>

</body>
</html>
